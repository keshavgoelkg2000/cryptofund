{
  "version": 3,
  "sources": ["../../@thirdweb-dev/sdk/dist/erc-20-history-aaf3a654.browser.esm.js"],
  "sourcesContent": ["import { constants, BigNumber } from 'ethers';\nimport { a as fetchCurrencyValue } from './smart-contract-40473f5e.browser.esm.js';\n\n/**\n * Manages history for Token contracts\n * @public\n */\nclass TokenERC20History {\n  constructor(contractWrapper, events) {\n    this.contractWrapper = contractWrapper;\n    this.events = events;\n  }\n\n  /**\n   * Get all holder balances\n   *\n   * @remarks Lets you get all token holders and their corresponding balances\n   * @returns - A JSON object of all token holders and their corresponding balances\n   * @example\n   * ```javascript\n   * const allHolderBalances = await contract.history.getAllHolderBalances();\n   * ```\n   */\n  async getAllHolderBalances() {\n    const a = await this.events.getEvents(\"Transfer\");\n    const txns = a.map(b => b.data);\n    const balances = {};\n    txns.forEach(item => {\n      const from = item?.from;\n      const to = item?.to;\n      const amount = item?.value;\n      if (!(from === constants.AddressZero)) {\n        if (!(from in balances)) {\n          balances[from] = BigNumber.from(0);\n        }\n        balances[from] = balances[from].sub(amount);\n      }\n      if (!(to === constants.AddressZero)) {\n        if (!(to in balances)) {\n          balances[to] = BigNumber.from(0);\n        }\n        balances[to] = balances[to].add(amount);\n      }\n    });\n    const entries = Object.entries(balances);\n    const results = await Promise.all(entries.map(_ref => {\n      let [, value] = _ref;\n      return fetchCurrencyValue(this.contractWrapper.getProvider(), this.contractWrapper.address, value);\n    }));\n    return entries.map((_ref2, index) => {\n      let [addr] = _ref2;\n      return {\n        holder: addr,\n        balance: results[index]\n      };\n    });\n  }\n}\n\nexport { TokenERC20History as T };\n"],
  "mappings": ";;;;;;;;;;;;;;;AAAA;AAAA;AAOA,IAAM,oBAAN,MAAwB;AAAA,EACtB,YAAY,iBAAiB,QAAQ;AACnC,SAAK,kBAAkB;AACvB,SAAK,SAAS;AAAA,EAChB;AAAA,EAYA,MAAM,uBAAuB;AAC3B,UAAM,IAAI,MAAM,KAAK,OAAO,UAAU,UAAU;AAChD,UAAM,OAAO,EAAE,IAAI,OAAK,EAAE,IAAI;AAC9B,UAAM,WAAW,CAAC;AAClB,SAAK,QAAQ,UAAQ;AACnB,YAAM,OAAO,6BAAM;AACnB,YAAM,KAAK,6BAAM;AACjB,YAAM,SAAS,6BAAM;AACrB,UAAI,EAAE,SAAS,YAAU,cAAc;AACrC,YAAI,EAAE,QAAQ,WAAW;AACvB,mBAAS,QAAQ,UAAU,KAAK,CAAC;AAAA,QACnC;AACA,iBAAS,QAAQ,SAAS,MAAM,IAAI,MAAM;AAAA,MAC5C;AACA,UAAI,EAAE,OAAO,YAAU,cAAc;AACnC,YAAI,EAAE,MAAM,WAAW;AACrB,mBAAS,MAAM,UAAU,KAAK,CAAC;AAAA,QACjC;AACA,iBAAS,MAAM,SAAS,IAAI,IAAI,MAAM;AAAA,MACxC;AAAA,IACF,CAAC;AACD,UAAM,UAAU,OAAO,QAAQ,QAAQ;AACvC,UAAM,UAAU,MAAM,QAAQ,IAAI,QAAQ,IAAI,UAAQ;AACpD,UAAI,CAAC,EAAE,KAAK,IAAI;AAChB,aAAO,mBAAmB,KAAK,gBAAgB,YAAY,GAAG,KAAK,gBAAgB,SAAS,KAAK;AAAA,IACnG,CAAC,CAAC;AACF,WAAO,QAAQ,IAAI,CAAC,OAAO,UAAU;AACnC,UAAI,CAAC,IAAI,IAAI;AACb,aAAO;AAAA,QACL,QAAQ;AAAA,QACR,SAAS,QAAQ;AAAA,MACnB;AAAA,IACF,CAAC;AAAA,EACH;AACF;",
  "names": []
}
